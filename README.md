1. Let us try to code a simple program that will actually retrieve a vulnerability from the associated open port from the software that is running there.
2. First we need to open both the kali linux and metasploitable. You need to check the IP address of both the machines and that it belongs to your IP range of local network.
   <img width="482" alt="image" src="https://github.com/juikalan21/returning-vulnerability-from-open-ports-using-metasploitable/assets/159107774/fdac888d-2489-4492-a39f-0caa90e34873">

   <img width="353" alt="image" src="https://github.com/juikalan21/returning-vulnerability-from-open-ports-using-metasploitable/assets/159107774/b9ba7ae4-47f5-4870-9194-7a53b64f7908">
4. Now we are good to go.
5. What we need to code is somthing similar to a port scanner. So we try for a certain range of ports. For example, first 50 ports. We will actually try to connect to the port but also receive something from those ports.
6. By this I mean receiving some bytes, banners which will most likely to be, either promting us to login or sending us the version of software they are running or the vulnerability of that open port as we want here.
7. import socket library, since with that we will be performing all actions such as connecting and receiving data from the port.
8. So lets make our funtion as usual, that will be our main() funtion. Lets first try to actually return a vulnerabilty/banner from a single port. Lets add port to be 22, which is the port for SSH which i know that is by default open on the metasploitable. Then add IP address of metasploitable.
   create a variable banner which will store the result of actual port sending us result,  it will be a funtion retBanner which we will code. This function will take an input of IP address and of the port.
9. We will prompt user for the IP address.

    def main():
        ip = input("Enter target IP:")
        for port in range(1,1000):
                banner = retBanner(ip,port)
                if banner:
                        print(ip, ":" , banner)
main()

10. We will create a socket object in retBanner function. And our variable banner will actually be what we receive from the host we scan. We want to recv 1024 bytes, this is the function used for receiving once we connect to the target. And it will store it in the banner variable. Lets hope that those 1024 bytes is the actual banner of the open port software that is running on SSH.

     import socket
     def retBanner(ip,port):
        try:
                socket.setdefaulttimeout(2)
                s = socket.socket()
                s.connect((ip,port))
                banner = s.recv(1024)
                return banner
        except:
                return

11. Result of single port
    <img width="381" alt="image" src="https://github.com/juikalan21/returning-vulnerability-from-open-ports-using-metasploitable/assets/159107774/4a0b27dc-d985-417f-a0fa-bb647cbe7ed7">

12. Result of multiple open ports
    <img width="487" alt="image" src="https://github.com/juikalan21/returning-vulnerability-from-open-ports-using-metasploitable/assets/159107774/613d1c99-0194-4263-a872-235641be33cf">

13. Then we can search for the exploits or vulnerabilties for this open port. 
    <img width="457" alt="image" src="https://github.com/juikalan21/returning-vulnerability-from-open-ports-using-metasploitable/assets/159107774/9f50b8ad-b7b4-4604-9cc2-3379a8d5dbc9">


